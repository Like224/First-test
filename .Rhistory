oaa
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa,aes(x = species, col = treatment)) + geom_blank(aes(y = activity)) +
oaa_new_mean
ggplot(oaa,aes(x = species, col = treatment)) + geom_blank(aes(y = activity))
ggplot(oaa_new,aes(x = species, col = treatment)) + geom_blank(aes(y = activity))geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, col = treatment)) + geom_blank(aes(y = activity))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
2
oaa_new <- group_by(oaa,loc,species)
oaa_new_mean <- summarise_at(group_by(oaa,loc,species),vars(activity),funs(mean(.,na.rm=TRUE)))
ggplot(oaa_new,aes(x = species, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
oaa_new_mean
oaa
oaa_new
ggplot(oaa_new,aes(x = species, y= activity)) + geom_errorbar(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_rbar(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_bar(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= loc),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= loc),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= loc),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
oaa_new <- group_by(oaa,loc,species,treatment)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
oaa_new
ggplot(oaa_new,aes(x = group, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
oaa_new <- oaa %>% mutate(treat = treatment) %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new
oaa_new <- oaa  %>% unite(col = "group", c(loc, treat), sep = "")
oaa
oaa_new <- oaa %>% mutate(treat = treatment) %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new,aes(x = group, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = group, y= activity)) + geom_boxplot(aes(col = loc))
oaa_new
ggplot(oaa_new,aes(x = group, y= activity)) + geom_boxplot(aes(col = group))
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = group))
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = group))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = group))+geom_jitter(aes(y = activity,col=group), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= group),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = group))+geom_jitter(aes(y = activity,col="group"), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= "group"),size = 3,shape = 21,stroke = 2)
oaa_new <- group_by(oaa,loc,species,treatment)
oaa_new
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = "treatment"))+geom_jitter(aes(y = activity,col="group"), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= "group"),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = "treatment"))+geom_jitter(aes(y = activity,col="treatment"), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= "treatment"),size = 3,shape = 21,stroke = 2)
task5
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = "treatment"))+geom_jitter(aes(y = activity,col="treatment"), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= "treatment"),size = 3,shape = 21,stroke = 2)
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
oaa_new_mean
oaa_new_mean <- summarise_at(group_by(oaa,loc,species),vars(activity),funs())
oaa_new_1 <- summarise_at(group_by(oaa,loc,species),vars(activity),funs())
oaa_new_1
oaa_new_1 <- summarise_at(group_by(oaa,loc,species),vars(activity),)
oaa_new_1 <- summarise_at(group_by(oaa,loc,species),vars(activity))
oaa_new_mean <- summarise_at(group_by(oaa,loc,species),vars(activity),funs(mean(.,na.rm=TRUE)))
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,),size = 3,shape = 21,stroke = 2)
oaa_new_mean
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col =  loc ),size = 3,shape = 21,stroke = 2)
plotfig <- function(specie){
oaa_new_1 <- oaa %>% filter(species == specie)
oaa_new_1 <- oaa_new_1  %>% unite(col = "group", c(loc, treat), sep = "_")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig("acantho")
oaa_new_1 <- oaa %>% filter(species == "acantho")
oaa_new_1 <- oaa_new_1  %>% unite(col = "group", c(loc, treat), sep = "_")
oaa_new_1 <- oaa_new_1  %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new_1 <- oaa %>% filter(species == "acantho")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = ativity,col=treatment), width = 0.25)
oaa_new_1
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = ativity,col=treatment), width = 0.25)
oaa_new_1
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa_new_1 <- oaa %>% filter(species == "acantho")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
oaa_new_1
oaa
oaa$loc = factor(oaa$loc, labels = c("14","15","16"))
oaa
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
plotfig <- function(specie){
oaa_new_1 <- oaa %>% filter(species == "specie")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig(acantho)
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
plotfig <- function(specie){
oaa_new_1 <- oaa %>% filter(species == "specie")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig(acantho)
plotfig <- function(specie,notfirst = TRUE){
oaa_new_1 <- oaa %>% filter(species == "specie")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig(acantho)
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa_new_1 <- oaa %>% filter(species == "acantho")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
plotfig <- function(specie,notfirst = TRUE){
oaa_new_1 <- oaa %>% filter(species == "specie")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig(acantho)
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
plotfig <- function(specie,notfirst = TRUE){
oaa_new_1 <- oaa %>% filter(species == "specie")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
plotfig(acantho)
plotfig(acantho)
plotfig("acantho")
plotfig <- function(specie,notfirst = TRUE){
oaa_new_1 <- oaa %>% filter(species == specie)
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig("acantho")
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig("acantho")
abc
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
abc
}
plotfig("acantho")
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
plotfig("acantho")
oaa
oaa
oaa <- read.csv('./data/OA_activitydat_20190302_BIOL3207.csv', header=TRUE)
oaa
oaa
oaa
oaa <- read.csv('./data/OA_activitydat_20190302_BIOL3207.csv', header=TRUE)
oaa
>**Question 9**: Think about some things that can be improved in their code.
>**Question 9**: Think about some things that can be improved in their code.
library(tidyverse)
oaa <- read.csv('./data/OA_activitydat_20190302_BIOL3207.csv', header=TRUE)
oaa
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col =  loc ),size = 3,shape = 21,stroke = 2)
oaa_new
ggplot(task5, aes(x = species, y = activity)) + geom_boxplot(aes(col = treatment))+scale_y_continuous(limits = c(0,70))
oaa_new_mean
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
plotfig("acantho")
for for (i in unique(new_data$species))
oaa_new_1
{
oaa_new_1 <- oaa %>% filter(species == i)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
oaa_new_1
oaa_new_1
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new_1
for (i in unique(oaa_new_1$species))
{
oaa_new_1 <- oaa_new_1 %>% filter(species == i)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
oaa_new_1 <- oaa_new_1 %>% filter(species == "i")
for (i in unique(oaa_new_1$species))
{
oaa_new_1 <- oaa_new_1 %>% filter(species == "i")
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_1 <- oaa_new_1 %>% filter(species == "i")
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
oaa_new_1
oaa_new_1
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new_1
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
abc <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
oaa_new_2
oaa_new_1
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2
oaa <- na.omit(oaa)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
pictur
}
print(pictur)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
oaa_new_2 <
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
oaa_new
oaa_new
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
>**Question 9**: Think about some things that can be improved in their code.
##**Question 9**: Think about some things that can be improved in their code.
##List 3 things you think could be improved and provide a brief explanation for why.
# 1)No ggplot package is used, only the original R is used, resulting in a huge amount of code and not too many comments, resulting in low readability of others, it will be better to use Rmarkdown
# 2) A large number of code is used to statistical testing. Many of them are useless in the final ploting, resulting in occupying a large amount of resources and running slowly, not concise.
# 3) The variable assignment is too casual, using too many variable names such as "chr1","qqp", making people forget the meaning of this variable when they see the code behind. And many variable names have been reused many times, can use new variable names  when changing.
library(tidyverse)
oaa <- read.csv('./data/OA_activitydat_20190302_BIOL3207.csv', header=TRUE)
oaa <- na.omit(oaa)
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col =  loc ),size = 3,shape = 21,stroke = 2)
oaa_new
ggplot(task5, aes(x = species, y = activity)) + geom_boxplot(aes(col = treatment))+scale_y_continuous(limits = c(0,70))
oaa_new_mean
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
plotfig("acantho")
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
q25 <-function(x){quantile(x,0.25)}
q75 <-function(x){quantile(x,0.75)}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(ymin = q25, ymax = q75)aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(ymin = q25, ymax = q75, col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(ymin = q25, ymax = q75)+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(ymin = q25, ymax = q75)+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(ymin = q25, ymax = q75)+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(ymin = q25, ymax = q75))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
i <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
"acantho" | 'lemon'|'chromis' | 'acantho'| 'humbug'|'whitedams'
"acantho"
acantho
print(acantho )
print(acantho)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
i <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(i)
}
print(i)
print(whitedams)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
i <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
a <- print(i)
}
print(whitedams)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
i <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.3)
print(i)
}
``{r}
pictur <- function(specie){
oaa_new_2 <- oaa_new_1 %>% filter(species == specie)
i <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.3)
print(i)
}
pictur("acantho") | pictur('lemon')
pictur("acantho") | pictur('lemon')
pictur("acantho") + pictur('lemon')
pictur("acantho"and"lemon")
pictur("acantho" |"lemon")
pall <- cowplot::plot_grid(acantho)
i
typeof(i)
pictur <- function(specie){
oaa_new_2 <- oaa_new_1 %>% filter(species == specie)
i <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.3)
print(i)
}
pictur("acantho")
pictur("acantho") |pictur("acantho")
pictur("acantho", notfirst = FALSE) | pictur("acantho")
pictur <- function(specie,notfirst = TRUE){
oaa_new_2 <- oaa_new_1 %>% filter(species == specie)
i <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.3)
print(i)
}
pictur("acantho",notfirst = FALSE) | pictur("acantho")
pictur <- function(specie,notfirst = TRUE){
oaa_new_2 <- oaa_new_1 %>% filter(species == specie)
pict <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.3)
pict <- pict + theme(legend.position="none", axis.text.y = element_blank()) + ylab(NULL)
pict
}
pictur("acantho",notfirst = FALSE) | pictur("acantho")
oaa_new_mean
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
i <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.3)
print(i)
}
pictur <- function(specie,{
pictur <- function(specie){
oaa_new_2 <- oaa_new_1 %>% filter(species == specie)
pict <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.3)
pict
}
knitr::opts_chunk$set(echo = TRUE)
options(digits=2)
# Add your code here.
n_rep <- 100
permutation_result <- tibble()
for (i in unique(new_data$species))
{
samp_dist <- rep(0,n_rep)
print(i)
for (i in 1:n_rep){
permutation <- sample(new_data$activity[which(new_data$species==i)], replace = F)
permuted_group_data <- new_data %>% filter(species==i)
permuted_group_data$activity <- permutation
samp_dist[i] <- t.test(permuted_group_data%>% filter(treatment == "control") %>% select(activity), permuted_group_data %>% filter(treatment == "CO2") %>% select(activity))
}
permutation_result <- rbind(sum(samp_dist)/n_rep)
}
# Add your code here.
for (i in unique(new_data$species))
{
print(i)
permutation <- sample(new_data$activity[which(new_data$species==i)], replace = F)
permuted_group_data <- new_data %>% filter(species==i)
permuted_group_data$activity <- permutation
outcome_permutation <- t.test(permuted_group_data%>% filter(treatment == "control") %>% select(activity), permuted_group_data %>% filter(treatment == "CO2") %>% select(activity))
print(outcome_permutation)
}
#After conducting the above experiment, we found that in all six species, the differences in the mean between the treatment and control groups largely disappeared, so it can basically be assumed that the difference in activity was due to the different conditions in the treatment and control groups
# Using the resulting object created above, which should be a table with all the summary statistics, t, df and p-value for each species create a table. Note that there is a tab.cap argument in the chunk arguments. Write a caption here.
new_stat.data <- subset(stat.test, select = -c(.y., group1,group2,n1,n2))
new_stat.data
str(outcome)
# Using the resulting object created above, which should be a table with all the summary statistics, t, df and p-value for each species create a table. Note that there is a tab.cap argument in the chunk arguments. Write a caption here.
new_stat.data <- subset(stat.test, select = -c(.y., group1,group2,n1,n2))
as.tabble(new_stat.data)
# Using the resulting object created above, which should be a table with all the summary statistics, t, df and p-value for each species create a table. Note that there is a tab.cap argument in the chunk arguments. Write a caption here.
new_stat.data <- subset(stat.test, select = -c(.y., group1,group2,n1,n2))
as.table(new_stat.data)
# Using the resulting object created above, which should be a table with all the summary statistics, t, df and p-value for each species create a table. Note that there is a tab.cap argument in the chunk arguments. Write a caption here.
new_stat.data <- subset(stat.test, select = -c(.y., group1,group2,n1,n2))
flextable(new_stat.data)
#After conducting the above experiment, we found that in all six species, the differences in the mean between the treatment and control groups largely disappeared, so it can basically be assumed that the difference in activity was due to the different conditions in the treatment and control groups
outcome_permutation
