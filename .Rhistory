activity_fit$uci <- activity_fit$fit + (1.96*activity_fit$se)
ac2015fit <- activity_fit
# time to make a plot.
jpeg('acantho activity models_20190304.jpg', width=14, height=7, units='in', res=600)
{
#define y and x label sequences
xlab <- seq(from=5, to=95, by=10)
#locations where y-labels will go.
ylab <- seq(from=0, to=60, by=10)
limX <- c(45, 95)
limY <- c(-5, 60)
par(mar=c(2,0.5,0.5,0.5)) #plot margins (bottom, left, top, right)
par(mfrow=c(1,2)) #number of rows and columns in for having murbtiple plots
par(oma=c(6,8,0,0.5)) #outer margin areas (bottom, left, top, right)
# LIRS 2014
#empty plot area
plot(NA, xlim=limX, ylim=limY, main=NULL, xlab=NULL, ylab=NULL, axes=FALSE)
polygon(c(ac2014fit[ac2014fit$treatment=='control',]$sl,
rev(ac2014fit[ac2014fit$treatment=='control',]$sl)),
c(ac2014fit[ac2014fit$treatment=='control',]$uci,
rev(ac2014fit[ac2014fit$treatment=='control',]$lci)), col = alpha("grey75", 0.5), border = NA)
polygon(c(ac2014fit[ac2014fit$treatment=='CO2',]$sl,
rev(ac2014fit[ac2014fit$treatment=='CO2',]$sl)),
c(ac2014fit[ac2014fit$treatment=='CO2',]$uci,
rev(ac2014fit[ac2014fit$treatment=='CO2',]$lci)), col = alpha("grey75", 0.5), border = NA)
points(activity ~ sl, data=foo[foo$treatment=='control' & foo$loc=='LIRS 2014',], cex=1.2, pch=18, col = 'grey40')
points(activity ~ sl, data=foo[foo$treatment=='CO2' & foo$loc=='LIRS 2014',], cex=1.1, pch=16, col = 'dodgerblue2')
lines(x = ac2014fit[ac2014fit$treatment=='CO2',]$sl,
y = ac2014fit[ac2014fit$treatment=='CO2',]$fit, lwd=3, col = 'dodgerblue2')
lines(x = ac2014fit[ac2014fit$treatment=='control',]$sl,
y = ac2014fit[ac2014fit$treatment=='control',]$fit, lwd=3, col = 'grey40')
axis(1, at = xlab, labels=xlab, cex.axis=1.6)
axis(2, at = ylab, labels=ylab, cex.axis=1.6, las=2)
mtext(expression(paste('Activity duration (', 's min'^'-1', ')')), side=2, line=3.25, cex=2)
mtext('Standard length (mm)', side=1, at = 95, line=4, cex=2)
text(x = 85, y = 55, labels = 'LIRS 2014', cex=2)
box(lwd=1.6)
# 2016
limX <- c(8,14)
plot(NA, xlim=limX, ylim=limY, main=NULL, xlab=NULL, ylab=NULL, axes=FALSE)
polygon(c(ac2015fit[ac2015fit$treatment=='control',]$sl,
rev(ac2015fit[ac2015fit$treatment=='control',]$sl)),
c(ac2015fit[ac2015fit$treatment=='control',]$uci,
rev(ac2015fit[ac2015fit$treatment=='control',]$lci)), col = alpha("grey75", 0.5), border = NA)
polygon(c(ac2015fit[ac2015fit$treatment=='CO2',]$sl,
rev(ac2015fit[ac2015fit$treatment=='CO2',]$sl)),
c(ac2015fit[ac2015fit$treatment=='CO2',]$uci,
rev(ac2015fit[ac2015fit$treatment=='CO2',]$lci)), col = alpha("grey75", 0.5), border = NA)
points(activity ~ sl, data=foo[foo$treatment=='control' & foo$loc=='AIMS 2015',], cex=1.2, pch=18, col = 'grey40')
points(activity ~ sl, data=foo[foo$treatment=='CO2' & foo$loc=='AIMS 2015',], cex=1.1, pch=16, col = 'dodgerblue2')
lines(x = ac2015fit[ac2015fit$treatment=='CO2',]$sl,
y = ac2015fit[ac2015fit$treatment=='CO2',]$fit, lwd=3, col = 'dodgerblue2')
lines(x = ac2015fit[ac2015fit$treatment=='control',]$sl,
y = ac2015fit[ac2015fit$treatment=='control',]$fit, lwd=3, col = 'grey40')
axis(1, at = c(8:14), labels=c(8:14), cex.axis=1.6)
text(x = 13, y = 55, labels = 'AIMS 2015', cex=2)
box(lwd=1.6)
dev.off()
}
# now, plot of humbug 2014 model
foo <- oaa[oaa$species=='humbug',]
foo <- foo[foo$loc=='LIRS 2014',]
summary(hum101)
range(foo$sl)
# script for predicting from 2014 humbugs
SL_seq <- seq(from=17, to=71, by=1) #SL
co2_seq <- rep('CO2', length(SL_seq))
control_seq <- rep('control', length(SL_seq))
treatment_seq <- c(control_seq, co2_seq)
sl_seq <- rep(SL_seq, 2)
length(sl_seq)
length(treatment_seq)
fake_data <- data.frame(treatment = treatment_seq, sl = sl_seq) #merge it all into a dataframe
str(fake_data) #cool, a fake dataset to predict from.
fake_data$treatment <- relevel(fake_data$treatment, ref = 'control')
pdat <- predict(hum101, fake_data, se.fit=TRUE)
activity_fit <- data.frame(treatment = treatment_seq, sl=sl_seq, fit = pdat$fit, se = pdat$se.fit)
activity_fit$lci <- activity_fit$fit - (1.96*activity_fit$se) #calculate lower and upper confidence intervals from the standard errors
activity_fit$uci <- activity_fit$fit + (1.96*activity_fit$se)
hum2014fit <- activity_fit
# humbug plot
jpeg('humbug activity model 2014_20190304.jpg', width=10, height=7, units='in', res=600)
{
#define y and x label sequences
xlab <- seq(from=20, to=70, by=10)
#locations where y-labels will go.
ylab <- seq(from=0, to=60, by=10)
limX <- c(17, 71)
limY <- c(0, 60)
par(mar=c(2,0.5,0.5,0.5)) #plot margins (bottom, left, top, right)
par(mfrow=c(1,1)) #number of rows and columns in for having murbtiple plots
par(oma=c(6,8,0,0.5)) #outer margin areas (bottom, left, top, right)
# LIRS 2014
#empty plot area
plot(NA, xlim=limX, ylim=limY, main=NULL, xlab=NULL, ylab=NULL, axes=FALSE)
polygon(c(hum2014fit[hum2014fit$treatment=='control',]$sl,
rev(hum2014fit[hum2014fit$treatment=='control',]$sl)),
c(hum2014fit[hum2014fit$treatment=='control',]$uci,
rev(hum2014fit[hum2014fit$treatment=='control',]$lci)), col = alpha("grey75", 0.5), border = NA)
polygon(c(hum2014fit[hum2014fit$treatment=='CO2',]$sl,
rev(hum2014fit[hum2014fit$treatment=='CO2',]$sl)),
c(hum2014fit[hum2014fit$treatment=='CO2',]$uci,
rev(hum2014fit[hum2014fit$treatment=='CO2',]$lci)), col = alpha("grey75", 0.5), border = NA)
points(activity ~ sl, data=foo[foo$treatment=='control' & foo$loc=='LIRS 2014',], cex=1.2, pch=18, col = 'grey40')
points(activity ~ sl, data=foo[foo$treatment=='CO2' & foo$loc=='LIRS 2014',], cex=1.1, pch=16, col = 'dodgerblue2')
lines(x = hum2014fit[hum2014fit$treatment=='CO2',]$sl,
y = hum2014fit[hum2014fit$treatment=='CO2',]$fit, lwd=3, col = 'dodgerblue2')
lines(x = hum2014fit[hum2014fit$treatment=='control',]$sl,
y = hum2014fit[hum2014fit$treatment=='control',]$fit, lwd=3, col = 'grey40')
axis(1, at = xlab, labels=xlab, cex.axis=1.6)
axis(2, at = ylab, labels=ylab, cex.axis=1.6, las=2)
mtext(expression(paste('Activity duration (', 's min'^'-1', ')')), side=2, line=3.25, cex=2)
mtext('Standard length (mm)', side=1, line=4, cex=2)
box(lwd=1.6)
dev.off()
}
library(tidyverse)
ggplot(oaa,aes(x = group, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25) +
geom_errorbar(data = stat, aes(ymin = q25, ymax = q75),width = 0.1, position = position_dodge2(width = 0.5, padding = 0.5)) +
geom_point(data = stat, aes(x = group, y = mean),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(selecting) +ylim(c(0,60))
ggplot(oaa,aes(x = group, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25) +
geom_errorbar(data = stat, aes(ymin = q25, ymax = q75),width = 0.1, position = position_dodge2(width = 0.5, padding = 0.5)) +
geom_point(data = stat, aes(x = group, y = mean),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = group, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25) +
geom_errorbar(data = stat, aes(ymin = q25, ymax = q75),width = 0.1, position = position_dodge2(width = 0.5, padding = 0.5)) +
geom_point(data = stat, aes(x = group, y = mean),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
oaa
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25) +
geom_errorbar(data = stat, aes(ymin = q25, ymax = q75),width = 0.1, position = position_dodge2(width = 0.5, padding = 0.5)) +
geom_point(data = stat, aes(x = group, y = mean),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  +
geom_point(data = stat, aes(x = group, y = mean),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  +
geom_point(data = stat, aes(x = species, y = mean),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = stat, aes(x = species, y = mean),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = mean),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = mean(activity),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = mean(activity),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = mean(activity),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = mean(activity),size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = activity,size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = activity,size = 3,shape = 21,stroke = 2) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = activity,size = 3,shape = 21,stroke = 2)) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = mena(activity),size = 3,shape = 21,stroke = 2)) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)  + geom_point(data = oaa, aes(x = species, y = mean(activity),size = 3,shape = 21,stroke = 2)) + theme(legend.position = "left", plot.title = element_text(margin = margin())) + xlab(oaa$treatment) +ylim(c(0,60))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)
oaa_new <- group_by(oaa,loc)
oaa_new <- group_by(oaa,loc)
ggplot(oaa_new,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)
oaa_new
# Drop irrelevant columns
new_data <- subset(data, select = -c(comment, loc))
# Check spelling in species and treatment but also generate a summary table
unique(new_data$species)
unique(new_data$treatment)
#use unique to check spelling error, it seems no spelling error
mat <- summarise_at(group_by(new_data,species),vars(activity),funs(mean(.,na.rm=TRUE),std.error(.,)))
# Use flextable to render the summary table in a tidy format
summarise_at(group_by(new_data,species),vars(activity),funs(mean(.,),std.error(.,)))
a <- summarise_at(group_by(new_data,species),vars(animal_id),funs(length(unique(.,))))
data_test <- subset(a, select = -c(species))
data_test2 <- cbind(mat,data_test)
data_test2
flextable(data_test2)
mat <- summarise_at(group_by(new_data,species),vars(activity),funs(mean(.,na.rm=TRUE),std.error(.,)))
summarise_at(group_by(new_data,species),vars(activity),funs(mean(.,),std.error(.,)))
a <- summarise_at(group_by(new_data,species),vars(animal_id),funs(length(unique(.,))))
# Drop irrelevant columns
new_data <- subset(data, select = -c(comment, loc))
# Check spelling in species and treatment but also generate a summary table
unique(new_data$species)
unique(new_data$treatment)
#use unique to check spelling error, it seems no spelling error
mat <- summarise_at(group_by(new_data,species),vars(activity),funs(mean(.,),std.error(.,)))
# Use flextable to render the summary table in a tidy format
a <- summarise_at(group_by(new_data,species),vars(animal_id),funs(length(unique(.,))))
data_test <- subset(a, select = -c(species))
data_test2 <- cbind(mat,data_test)
data_test2
flextable(data_test2)
oaa_new_mean <- summarise_at(group_by(oaa,loc),vars(activity),funs(mean(.,)))
oaa_new_mean
# Drop irrelevant columns
new_data <- subset(data, select = -c(comment, loc))
# Check spelling in species and treatment but also generate a summary table
unique(new_data$species)
unique(new_data$treatment)
#use unique to check spelling error, it seems no spelling error
mat <- summarise_at(group_by(new_data,species),vars(activity),funs(mean(.,),std.error(.,)))
# Use flextable to render the summary table in a tidy format
a <- summarise_at(group_by(new_data,species),vars(animal_id),funs(length(unique(.,))))
data_test <- subset(a, select = -c(species))
data_test2 <- cbind(mat,data_test)
data_test2
flextable(data_test2)
oaa_new_mean <- summarise_at(group_by(oaa,loc),vars(activity),funs(mean(.,na.rm=TRUE)))
oaa_new_mean
oaa_new_mean <- summarise_at(group_by(oaa,loc,species),vars(activity),funs(mean(.,na.rm=TRUE)))
oaa_new_mean
ggplot(oaa_new,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)
oaa_new_mean
ggplot(oaa_new,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = actiyity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
oaa_new <- group_by(oaa,loc)
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa,aes(x = species, colour = treatment))
oaa
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity))
ggplot(oaa,aes(x = species, colour = treatment)) + geom_blank(aes(y = activity)) + geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa,aes(x = species, col = treatment)) + geom_blank(aes(y = activity)) +
oaa_new_mean
ggplot(oaa,aes(x = species, col = treatment)) + geom_blank(aes(y = activity))
ggplot(oaa_new,aes(x = species, col = treatment)) + geom_blank(aes(y = activity))geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, col = treatment)) + geom_blank(aes(y = activity))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
2
oaa_new <- group_by(oaa,loc,species)
oaa_new_mean <- summarise_at(group_by(oaa,loc,species),vars(activity),funs(mean(.,na.rm=TRUE)))
ggplot(oaa_new,aes(x = species, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
oaa_new_mean
oaa
oaa_new
ggplot(oaa_new,aes(x = species, y= activity)) + geom_errorbar(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_rbar(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_bar(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= loc),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= loc),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= loc),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
oaa_new <- group_by(oaa,loc,species,treatment)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
oaa_new
ggplot(oaa_new,aes(x = group, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
oaa_new <- oaa %>% mutate(treat = treatment) %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new
oaa_new <- oaa  %>% unite(col = "group", c(loc, treat), sep = "")
oaa
oaa_new <- oaa %>% mutate(treat = treatment) %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new,aes(x = group, y= activity)) + geom_boxplot(aes(col = loc))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = group, y= activity)) + geom_boxplot(aes(col = loc))
oaa_new
ggplot(oaa_new,aes(x = group, y= activity)) + geom_boxplot(aes(col = group))
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = group))
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = group))+geom_jitter(aes(y = activity,col=loc), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = group))+geom_jitter(aes(y = activity,col=group), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= group),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = group))+geom_jitter(aes(y = activity,col="group"), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= "group"),size = 3,shape = 21,stroke = 2)
oaa_new <- group_by(oaa,loc,species,treatment)
oaa_new
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = "treatment"))+geom_jitter(aes(y = activity,col="group"), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= "group"),size = 3,shape = 21,stroke = 2)
ggplot(oaa_new,aes(x = species, y= activity)) + geom_boxplot(aes(col = "treatment"))+geom_jitter(aes(y = activity,col="treatment"), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= "treatment"),size = 3,shape = 21,stroke = 2)
task5
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = "treatment"))+geom_jitter(aes(y = activity,col="treatment"), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= "treatment"),size = 3,shape = 21,stroke = 2)
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col= treatment),size = 3,shape = 21,stroke = 2)
oaa_new_mean
oaa_new_mean <- summarise_at(group_by(oaa,loc,species),vars(activity),funs())
oaa_new_1 <- summarise_at(group_by(oaa,loc,species),vars(activity),funs())
oaa_new_1
oaa_new_1 <- summarise_at(group_by(oaa,loc,species),vars(activity),)
oaa_new_1 <- summarise_at(group_by(oaa,loc,species),vars(activity))
oaa_new_mean <- summarise_at(group_by(oaa,loc,species),vars(activity),funs(mean(.,na.rm=TRUE)))
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,),size = 3,shape = 21,stroke = 2)
oaa_new_mean
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col =  loc ),size = 3,shape = 21,stroke = 2)
plotfig <- function(specie){
oaa_new_1 <- oaa %>% filter(species == specie)
oaa_new_1 <- oaa_new_1  %>% unite(col = "group", c(loc, treat), sep = "_")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig("acantho")
oaa_new_1 <- oaa %>% filter(species == "acantho")
oaa_new_1 <- oaa_new_1  %>% unite(col = "group", c(loc, treat), sep = "_")
oaa_new_1 <- oaa_new_1  %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new_1 <- oaa %>% filter(species == "acantho")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = ativity,col=treatment), width = 0.25)
oaa_new_1
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = ativity,col=treatment), width = 0.25)
oaa_new_1
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa_new_1 <- oaa %>% filter(species == "acantho")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
oaa_new_1
oaa
oaa$loc = factor(oaa$loc, labels = c("14","15","16"))
oaa
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
plotfig <- function(specie){
oaa_new_1 <- oaa %>% filter(species == "specie")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig(acantho)
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
plotfig <- function(specie){
oaa_new_1 <- oaa %>% filter(species == "specie")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig(acantho)
plotfig <- function(specie,notfirst = TRUE){
oaa_new_1 <- oaa %>% filter(species == "specie")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig(acantho)
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa_new_1 <- oaa %>% filter(species == "acantho")
oaa_new_1 <- oaa_new_1%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
plotfig <- function(specie,notfirst = TRUE){
oaa_new_1 <- oaa %>% filter(species == "specie")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig(acantho)
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
plotfig <- function(specie,notfirst = TRUE){
oaa_new_1 <- oaa %>% filter(species == "specie")
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
plotfig(acantho)
plotfig(acantho)
plotfig("acantho")
plotfig <- function(specie,notfirst = TRUE){
oaa_new_1 <- oaa %>% filter(species == specie)
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig("acantho")
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
plotfig("acantho")
abc
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
abc
}
plotfig("acantho")
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
plotfig("acantho")
oaa
oaa
oaa <- read.csv('./data/OA_activitydat_20190302_BIOL3207.csv', header=TRUE)
oaa
oaa
oaa
oaa <- read.csv('./data/OA_activitydat_20190302_BIOL3207.csv', header=TRUE)
oaa
>**Question 9**: Think about some things that can be improved in their code.
>**Question 9**: Think about some things that can be improved in their code.
library(tidyverse)
oaa <- read.csv('./data/OA_activitydat_20190302_BIOL3207.csv', header=TRUE)
oaa
ggplot(oaa,aes(x = species, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)+geom_point(data = oaa_new_mean, aes(x = species, y = activity,col =  loc ),size = 3,shape = 21,stroke = 2)
oaa_new
ggplot(task5, aes(x = species, y = activity)) + geom_boxplot(aes(col = treatment))+scale_y_continuous(limits = c(0,70))
oaa_new_mean
oaa$loc = factor(oaa$loc, labels = c("15","14","16"))
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
plotfig("acantho")
for for (i in unique(new_data$species))
oaa_new_1
{
oaa_new_1 <- oaa %>% filter(species == i)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
oaa_new_1
oaa_new_1
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new_1
for (i in unique(oaa_new_1$species))
{
oaa_new_1 <- oaa_new_1 %>% filter(species == i)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
oaa_new_1 <- oaa_new_1 %>% filter(species == "i")
for (i in unique(oaa_new_1$species))
{
oaa_new_1 <- oaa_new_1 %>% filter(species == "i")
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_1 <- oaa_new_1 %>% filter(species == "i")
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
oaa_new_1
oaa_new_1
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
oaa_new_1
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
abc <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
oaa_new_2
oaa_new_1
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2
oaa <- na.omit(oaa)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
oaa_new_1 <- oaa%>%mutate(treat = treatment)  %>% unite(col = "group", c(loc, treat), sep = "")
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
}
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
pictur
}
print(pictur)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == "i")
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
oaa_new_2 <
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2 <- oaa_new_1 %>% filter(species == "acantho")
oaa_new_2
ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
plotfig <- function(specie,notfirst = F){
oaa_new_1 <- oaa %>% filter(species == specie)
abc <- ggplot(oaa_new_1,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(abc)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_blank(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_errorbar(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
for (i in unique(oaa_new_1$species))
{
oaa_new_2 <- oaa_new_1 %>% filter(species == i)
pictur <- ggplot(oaa_new_2,aes(x = group, y= activity)) + geom_boxplot(aes(col = treatment))+geom_jitter(aes(y = activity,col=treatment), width = 0.25)
print(pictur)
}
oaa_new
oaa_new
